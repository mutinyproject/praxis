#!/bin/sh
eerror() {
	pstderr "${color_red}!!${color_reset} %s\n" "$@"
}

ewarning() {
	pstderr "${color_yellow}!?${color_reset} ${msg}" "$@"
}

einfo() {
	printf "${color_green}..${color_reset} %s\n" "$@"
}

default_pkg_init() { :; }

default_src_fetch() {
	OLDIFS="${IFS}"; IFS=$'\n'; set -- "${SOURCES}"; IFS="${OLDIFS}"; unset OLDIFS

	while [ $# -gt 0 ]; do
		local output="${FETCHDIR}"/"$(basename "$1")"
		if ! [ -f "${output}" ]; then
			edo curl -# -L -C - -o "${output}".part "$1"
			edo mv "${output}".part "${output}"
		fi

		shift
	done
}

default_src_unpack() { :; }
default_src_prepare() { :; }
# purposefully undefined: default_src_configure()
# purposefully undefined: default_src_test()
# purposefully undefined: default_src_install()
default_pkg_premerge() { :; }
default_pkg_postmerge() { :; }

pkg_init() { default_pkg_init "$@"; }
src_fetch() { default_src_fetch "$@"; }
src_unpack() { default_src_unpack "$@"; }
src_prepare() { default_src_prepare "$@"; }
src_configure() { eerror -d "phase 'src_configure' is not defined!\n"; }
src_test() { eerror -d "phase 'src_test' is not defined!\n"; }
src_install() { eerror -d "phase 'src_install' is not defined!\n"; }
pkg_premerge() { default_pkg_premerge "$@"; }
pkg_postmerge() { default_pkg_postmerge "$@"; }
