#!/bin/sh

if [ -z "${NO_COLOR}" ]; then
	color_red=$(tput setaf 1)
	color_yellow=$(tput setaf 3)
	color_reset=$(tput sgr0)
fi

edo() {
	local dry_run=false arg
	[ "$1" = -d ] && local dry_run=true && shift

	stderr "+ %s\n" "$*"
	"${dry_run}" || "$@"
}

die() {
	[ "$#" -gt 0 ] && stderr "$@"
	#pstree "${PRAXIS_PID:-$$}"
	exit
}

error() {
	local die=false
	case "${1}" in
		-d|--die)
			die=true
			shift
			;;
	esac

	local msg="${1}"; shift
	stderr "${color_red}!!${color_reset} ${msg}" "$@"
	"${die}" && die
}

warning() {
	local msg="${1}"; shift
	stderr "${color_yellow}!?${color_reset} ${msg}" "$@"
}

stderr() {
	printf "$@" >&2
}

